generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Usuario {
  id              Int               @id @default(autoincrement())
  password        String
  email           String            @unique
  rol             Rol               @default(DOCENTE)
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  Bitacora        Bitacora[]
  DatosPersonales DatosPersonales[]
}

model Bitacora {
  id        Int              @id @default(autoincrement())
  usuarioId Int
  usuario   Usuario          @relation(fields: [usuarioId], references: [id])
  accion    String
  type      AccionesBitacora
  ip        String
  hora      DateTime         @default(now())
  fecha     DateTime         @updatedAt
  mensaje   String?
}

model DatosPersonales {
  id              Int          @id @default(autoincrement())
  usuarioId       Int
  usuario         Usuario      @relation(fields: [usuarioId], references: [id])
  direccionId     Int?
  direccion       Direccion?   @relation(fields: [direccionId], references: [id])
  primerNombre    String
  segundoNombre   String?
  tercerNombre    String?
  primerApellido  String
  segundoApellido String?
  sexo            Sex
  fechaNacimiento DateTime
  numeroCedula    String
  numeroBancario  String?
  telefono        String?
  Expediente      Expediente[]
}

model Direccion {
  id                 Int               @id @default(autoincrement())
  zonaUrbanizacionId Int
  zonaUrbanizacion   ZonaUrbanizacion  @relation(fields: [zonaUrbanizacionId], references: [id])
  calle              String
  numeroCasa         String
  DatosPersonales    DatosPersonales[]
}

model ZonaUrbanizacion {
  id           Int         @id @default(autoincrement())
  estadoPaisId Int
  estadoPais   EstadoPais  @relation(fields: [estadoPaisId], references: [id])
  codigoPostal Int
  zona         String
  Direccion    Direccion[]
}

model EstadoPais {
  id               Int                @id @default(autoincrement())
  estado           String
  ZonaUrbanizacion ZonaUrbanizacion[]
}

model Expediente {
  id                Int             @id @default(autoincrement())
  datosPersonalesId Int
  datosPersonales   DatosPersonales @relation(fields: [datosPersonalesId], references: [id])
}

model CedulaAutorizada {
  id      Int                    @id @default(autoincrement())
  cedula  Int                    @unique
  estatus CedulaAutorizadaStatus @default(ACTIVO)
}

enum CedulaAutorizadaStatus {
  ACTIVO
  INACTIVO
}

enum AccionesBitacora {
  LOGIN
  ERROR
}

enum Rol {
  SUPER
  ADMIN
  AREA
  DOCENTE
}

enum Sex {
  HOMBRE
  MUJER
}
